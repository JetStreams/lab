THREE.STLLoader=function(){};THREE.STLLoader.prototype={constructor:THREE.STLLoader};THREE.STLLoader.prototype.load=function(a,e){var b=this;var d=new XMLHttpRequest();function c(f){if(f.target.status===200||f.target.status===0){var g=b.parse(f.target.response||f.target.responseText);b.dispatchEvent({type:"load",content:g});if(e){e(g)}}else{b.dispatchEvent({type:"error",message:"Couldn't load URL ["+a+"]",response:f.target.responseText})}}d.addEventListener("load",c,false);d.addEventListener("progress",function(f){b.dispatchEvent({type:"progress",loaded:f.loaded,total:f.total})},false);d.addEventListener("error",function(){b.dispatchEvent({type:"error",message:"Couldn't load URL ["+a+"]"})},false);if(d.overrideMimeType){d.overrideMimeType("text/plain; charset=x-user-defined")}d.open("GET",a,true);d.responseType="arraybuffer";d.send(null)};THREE.STLLoader.prototype.parse=function(c){var b=function(){var f,e,g,d;d=new DataView(a);e=(32/8*3)+((32/8*3)*3)+(16/8);g=d.getUint32(80,true);f=80+(32/8)+(g*e);return f===d.byteLength};var a=this.ensureBinary(c);return b()?this.parseBinary(a):this.parseASCII(this.ensureString(c))};THREE.STLLoader.prototype.parseBinary=function(g){var h=new DataView(g);var b=h.getUint32(80,true);var e=84;var c=12*4+2;var d=0;var k=new THREE.TypedGeometry(b);for(var j=0;j<b;j++){var a=e+j*c;for(var f=1;f<=3;f++){var l=a+f*12;k.vertices[d]=h.getFloat32(l,true);k.vertices[d+1]=h.getFloat32(l+4,true);k.vertices[d+2]=h.getFloat32(l+8,true);k.normals[d]=h.getFloat32(a,true);k.normals[d+1]=h.getFloat32(a+4,true);k.normals[d+2]=h.getFloat32(a+8,true);d+=3}}return k};THREE.STLLoader.prototype.parseASCII=function(d){var g,a,f,b,c,e,i,h;g=new THREE.Geometry();b=/facet([\s\S]*?)endfacet/g;while((i=b.exec(d))!==null){h=i[0];c=/normal[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g;while((i=c.exec(h))!==null){f=new THREE.Vector3(parseFloat(i[1]),parseFloat(i[3]),parseFloat(i[5]))}e=/vertex[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g;while((i=e.exec(h))!==null){g.vertices.push(new THREE.Vector3(parseFloat(i[1]),parseFloat(i[3]),parseFloat(i[5])))}a=g.vertices.length;g.faces.push(new THREE.Face3(a-3,a-2,a-1,f))}g.computeBoundingBox();g.computeBoundingSphere();return g};THREE.STLLoader.prototype.ensureString=function(a){if(typeof a!=="string"){var c=new Uint8Array(a);var d="";for(var b=0;b<a.byteLength;b++){d+=String.fromCharCode(c[b])}return d}else{return a}};THREE.STLLoader.prototype.ensureBinary=function(a){if(typeof a==="string"){var c=new Uint8Array(a.length);for(var b=0;b<a.length;b++){c[b]=a.charCodeAt(b)&255}return c.buffer||c}else{return a}};THREE.EventDispatcher.prototype.apply(THREE.STLLoader.prototype);if(typeof DataView==="undefined"){DataView=function(a,c,b){this.buffer=a;this.byteOffset=c||0;this.byteLength=b||a.byteLength||a.length;this._isString=typeof a==="string"};DataView.prototype={_getCharCodes:function(b,f,e){f=f||0;e=e||b.length;var a=f+e;var c=[];for(var d=f;d<a;d++){c.push(b.charCodeAt(d)&255)}return c},_getBytes:function(c,b,d){var a;if(d===undefined){d=this._littleEndian}if(b===undefined){b=this.byteOffset}else{b=this.byteOffset+b}if(c===undefined){c=this.byteLength-b}if(typeof b!=="number"){throw new TypeError("DataView byteOffset is not a number")}if(c<0||b+c>this.byteLength){throw new Error("DataView length or (byteOffset+length) value is out of bounds")}if(this.isString){a=this._getCharCodes(this.buffer,b,b+c)}else{a=this.buffer.slice(b,b+c)}if(!d&&c>1){if(!(a instanceof Array)){a=Array.prototype.slice.call(a)}a.reverse()}return a},getFloat64:function(e,g){var a=this._getBytes(8,e,g),c=1-(2*(a[7]>>7)),f=((((a[7]<<1)&255)<<3)|(a[6]>>4))-((1<<10)-1),d=((a[6]&15)*Math.pow(2,48))+(a[5]*Math.pow(2,40))+(a[4]*Math.pow(2,32))+(a[3]*Math.pow(2,24))+(a[2]*Math.pow(2,16))+(a[1]*Math.pow(2,8))+a[0];if(f===1024){if(d!==0){return NaN}else{return c*Infinity}}if(f===-1023){return c*d*Math.pow(2,-1022-52)}return c*(1+d*Math.pow(2,-52))*Math.pow(2,f)},getFloat32:function(e,g){var a=this._getBytes(4,e,g),c=1-(2*(a[3]>>7)),f=(((a[3]<<1)&255)|(a[2]>>7))-127,d=((a[2]&127)<<16)|(a[1]<<8)|a[0];if(f===128){if(d!==0){return NaN}else{return c*Infinity}}if(f===-127){return c*d*Math.pow(2,-126-23)}return c*(1+d*Math.pow(2,-23))*Math.pow(2,f)},getInt32:function(c,d){var a=this._getBytes(4,c,d);return(a[3]<<24)|(a[2]<<16)|(a[1]<<8)|a[0]},getUint32:function(a,b){return this.getInt32(a,b)>>>0},getInt16:function(a,b){return(this.getUint16(a,b)<<16)>>16},getUint16:function(c,d){var a=this._getBytes(2,c,d);return(a[1]<<8)|a[0]},getInt8:function(a){return(this.getUint8(a)<<24)>>24},getUint8:function(a){return this._getBytes(1,a)[0]}}};